
import re

html = """
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>NixOS Search - Packages - steam</title><link rel="stylesheet" href="/bootstrap.min.css"><link rel="stylesheet" href="/bootstrap-responsive.min.css"><link rel="shortcut icon" type="image/png" href="/favicon.png"><link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96"><link rel="search" type="application/opensearchdescription+xml" title="NixOS packages" href="/desc-search-packages.xml"><link rel="search" type="application/opensearchdescription+xml" title="NixOS options" href="/desc-search-options.xml"><script defer="defer" src="bundle.js"></script><link href="main-613e0aa2204801e53208.css" rel="stylesheet"><style></style></head><body><shortcut-element id="shortcut-list-el"><div><header><div class="navbar navbar-static-top"><div class="navbar-inner"><div class="container"><a class="brand" href="https://nixos.org"><img alt="NixOS logo" src="/images/nix-logo.png" class="logo"></a><div><ul class="nav pull-left"><li><a href="https://nixos.org">Back to nixos.org</a></li><li class="active"><a href="/packages?query=steam">Packages</a></li><li class=""><a href="/options?query=steam">NixOS options</a></li><li class=""><a href="/flakes?query=steam"><span>Flakes<sup><span class="label label-info"><small>Experimental</small></span></sup></span></a></li><li><a href="https://wiki.nixos.org">NixOS Wiki</a></li></ul></div></div></div></div></header><div class="container main"><div id="content"><div class="search-page success"><h1>Search more than <strong>120 000 packages</strong></h1><form class="search-input"><div><div><input type="text" id="search-query-input" autofocus="" placeholder="Search for packages"></div><button class="btn" type="submit">Search</button></div><div><div><h2>Channel: </h2><div class="btn-group" data-toggle="buttons-radio"><button type="button" class="btn">25.05 <span class="label label-warning">Deprecated</span></button><button type="button" class="btn active">25.11</button><button type="button" class="btn">unstable</button></div></div></div></form><div class="search-results"><ul class="search-sidebar"><li><ul><li class="header">Package sets</li><li><a href="#" class=""><span>No package set</span><span><span class="badge">44</span></span></a></li><li><a href="#" class=""><span>python313Packages</span><span><span class="badge">7</span></span></a></li><li><a href="#" class=""><span>python312Packages</span><span><span class="badge">7</span></span></a></li><li><a href="#" class=""><span>steampipePackages</span><span><span class="badge">3</span></span></a></li><li><a href="#" class=""><span>kodiPackages</span><span><span class="badge">3</span></span></a></li><li><a href="#" class=""><span>sbclPackages</span><span><span class="badge">2</span></span></a></li><li><a href="#" class=""><span>home-assistant-component-tests</span><span><span class="badge">2</span></span></a></li><li><a href="#" class=""><span>gnomeExtensions</span><span><span class="badge">2</span></span></a></li><li><a href="#" class=""><span>haskellPackages</span><span><span class="badge">1</span></span></a></li><li><a href="#" class=""><span>emacsPackages</span><span><span class="badge">1</span></span></a></li></ul></li><li><ul><li class="header">Licenses</li><li><a href="#" class=""><span>MIT License</span><span><span class="badge">21</span></span></a></li><li><a href="#" class=""><span>Apache License 2.0</span><span><span class="badge">13</span></span></a></li><li><a href="#" class=""><span>Unfree redistributable</span><span><span class="badge">5</span></span></a></li><li><a href="#" class=""><span>GNU General Public License v3.0 or later</span><span><span class="badge">5</span></span></a></li><li><a href="#" class=""><span>GNU General Public License v3.0</span><span><span class="badge">5</span></span></a></li><li><a href="#" class=""><span>GNU General Public License v3.0 only</span><span><span class="badge">4</span></span></a></li><li><a href="#" class=""><span>GNU General Public License v2.0 only</span><span><span class="badge">4</span></span></a></li><li><a href="#" class=""><span>GNU General Public License v2.0 or later</span><span><span class="badge">3</span></span></a></li><li><a href="#" class=""><span>BSD 2-clause "Simplified" License</span><span><span class="badge">3</span></span></a></li><li><a href="#" class=""><span>ISC License</span><span><span class="badge">2</span></span></a></li><li><a href="#" class=""><span>zlib License</span><span><span class="badge">1</span></span></a></li><li><a href="#" class=""><span>Valve Corporation Steamworks SDK Access Agreement</span><span><span class="badge">1</span></span></a></li><li><a href="#" class=""><span>Toyoda Masashi's free software license</span><span><span class="badge">1</span></span></a></li><li><a href="#" class=""><span>The Unlicense</span><span><span class="badge">1</span></span></a></li><li><a href="#" class=""><span>GNU Lesser General Public License v3.0 only</span><span><span class="badge">1</span></span></a></li><li><a href="#" class=""><span>GNU Affero General Public License v3.0 only</span><span><span class="badge">1</span></span></a></li><li><a href="#" class=""><span>Creative Commons Zero v1.0 Universal</span><span><span class="badge">1</span></span></a></li><li><a href="#" class=""><span>BSD 3-clause "New" or "Revised" License</span><span><span class="badge">1</span></span></a></li><li><a href="#" class=""><span>Apple Public Source License 2.0</span><span><span class="badge">1</span></span></a></li></ul></li><li><ul><li class="header">Maintainers</li><li><a href="#" class=""><span>Fabian Affolter</span><span><span class="badge">8</span></span></a></li><li><a href="#" class=""><span>Sefa Eyeoglu</span><span><span class="badge">5</span></span></a></li><li><a href="#" class=""><span>weirdrock</span><span><span class="badge">4</span></span></a></li><li><a href="#" class=""><span>Robert Sch√ºtz</span><span><span class="badge">4</span></span></a></li><li><a href="#" class=""><span>Ilya K.</span><span><span class="badge">4</span></span></a></li><li><a href="#" class=""><span>Sergey Kazenyuk</span><span><span class="badge">3</span></span></a></li><li><a href="#" class=""><span>R√©mi Nicole</span><span><span class="badge">3</span></span></a></li><li><a href="#" class=""><span>Peter Hoeg</span><span><span class="badge">3</span></span></a></li><li><a href="#" class=""><span>Gliczy</span><span><span class="badge">3</span></span></a></li><li><a href="#" class=""><span>Edward Tj√∂rnhammar</span><span><span class="badge">3</span></span></a></li><li><a href="#" class=""><span>Dominik Schrempf</span><span><span class="badge">3</span></span></a></li><li><a href="#" class=""><span>Carles Pag√®s</span><span><span class="badge">3</span></span></a></li><li><a href="#" class=""><span>Anthony Roussel</span><span><span class="badge">3</span></span></a></li><li><a href="#" class=""><span>Aaron Andersen</span><span><span class="badge">3</span></span></a></li><li><a href="#" class=""><span>Jung seungwoo</span><span><span class="badge">2</span></span></a></li><li><a href="#" class=""><span>Hraban Luyat</span><span><span class="badge">2</span></span></a></li><li><a href="#" class=""><span>Fuzen</span><span><span class="badge">2</span></span></a></li><li><a href="#" class=""><span>Daniel Nagy</span><span><span class="badge">2</span></span></a></li><li><a href="#" class=""><span>Atemu</span><span><span class="badge">2</span></span></a></li><li><a href="#" class=""><span>Arseniy Seroka</span><span><span class="badge">2</span></span></a></li></ul></li><li><ul><li class="header">Teams</li><li><a href="#" class=""><span>Kodi</span><span><span class="badge">3</span></span></a></li><li><a href="#" class=""><span>lisp</span><span><span class="badge">2</span></span></a></li><li><a href="#" class=""><span>Steam</span><span><span class="badge">2</span></span></a></li><li><a href="#" class=""><span>Home Assistant</span><span><span class="badge">2</span></span></a></li><li><a href="#" class=""><span>NGI</span><span><span class="badge">1</span></span></a></li><li><a href="#" class=""><span>GNOME Circle</span><span><span class="badge">1</span></span></a></li></ul></li><li><ul><li class="header">Platforms</li><li><a href="#" class=""><span>x86_64-linux</span><span><span class="badge">64</span></span></a></li><li><a href="#" class=""><span>aarch64-linux</span><span><span class="badge">55</span></span></a></li><li><a href="#" class=""><span>i686-linux</span><span><span class="badge">51</span></span></a></li></ul></li></ul><div class=""><div><div class="btn-group dropdown pull-right "><button class="btn"><span>Sort: </span><span class="selected">Best match</span><span class="caret"></span></button><ul class="pull-right dropdown-menu"><li class=" header">Sort options</li><li class="divider"></li><li class="selected"><a href="#">Best match</a></li><li class=""><a href="#">Alphabetically Ascending</a></li><li class=""><a href="#">Alphabetically Descending</a></li></ul></div><h2>Showing results 1-50 of <strong>72 packages</strong>.</h2>Data from nixpkgs <a href="https://github.com/NixOS/nixpkgs/tree/76701a179d3a98b07653e2b0409847499b2a07d3"><code>76701a17</code></a>.</div><ul><li class="package " id="result-steam"><span><a href="">steam</a></span><div>Digital distribution platform</div><ul><li>Name: <code class="package-name">steam</code></li><li>Version: <strong>1.0.0.85</strong></li><li><a href="https://store.steampowered.com/" target="_blank">üåê Homepage</a></li><li><a href="https://github.com/NixOS/nixpkgs/blob/nixos-25.11/pkgs/by-name/st/steam-unwrapped/package.nix#L47" target="_blank">üì¶ Source</a></li><li>License: Unfree redistributable</li></ul><div class="result-item-show-more-wrapper"><a href="#" class="result-item-show-more">‚ñæ‚ñæ‚ñæ Show more package details ‚ñæ‚ñæ‚ñæ</a></div></li><li class="package " id="result-steamcmd"><span><a href="">steamcmd</a></span><div>Steam command-line tools</div><ul><li>Name: <code class="package-name">steamcmd</code></li><li>Version: <strong>20180104</strong></li><li><a href="https://developer.valvesoftware.com/wiki/SteamCMD" target="_blank">üåê Homepage</a></li><li><a href="https://github.com/NixOS/nixpkgs/blob/nixos-25.11/pkgs/by-name/st/steamcmd/package.nix#L50" target="_blank">üì¶ Source</a></li><li>License: Unfree redistributable</li></ul><div class="result-item-show-more-wrapper"><a href="#" class="result-item-show-more">‚ñæ‚ñæ‚ñæ Show more package details ‚ñæ‚ñæ‚ñæ</a></div></li></ul><div><ul class="pager"><li><button class="btn" disabled="">First</button></li><li><button class="btn" disabled="">Previous</button></li><li><button class="btn">Next</button></li><li><button class="btn">Last</button></li></ul></div></div></div></div></div><footer class="container text-center"><div><span>Please help us improve the search by </span><a href="https://github.com/NixOS/nixos-search/issues">reporting issues</a><span>.</span></div><div><span>‚ù§Ô∏è  </span><span>Elasticsearch instance graciously provided by </span><a href="https://bonsai.io">Bonsai</a><span>. Thank you! ‚ù§Ô∏è </span></div></footer></div></div></shortcut-element></body></html>
"""

candidates = []

# Reproducing the logic from brain.py around line 889
try:
    items = html.split('<li class="package')[1:]
    print(f"Split detected {len(items)} items")

    for i, item in enumerate(items[:15]):
        print(f"--- Item {i} ---")
        # Extract Name
        name_match = re.search(r'<span><a href=".*?">(.*?)</a></span>', item)
        if hasattr(name_match, 'group'):
            name = name_match.group(1).strip()
            print(f"Name Match: '{name}'")
        else:
            print("Name Match: FAILED")
            print(f"Snippet: {item[:100]}...")
        
        # Extract Description
        desc_match = re.search(r'</span><div>(.*?)</div>', item)
        if hasattr(desc_match, 'group'):
            desc = desc_match.group(1).strip()
            print(f"Desc Match: '{desc}'")
        else:
            print("Desc Match: FAILED")

        if name_match:
             candidates.append(f"{name}: {desc if desc_match else 'No description'}")
except Exception as e:
    print(f"Error: {e}")

print(f"Candidates found: {candidates}")
